from ctypes import *

COLORS = {
    0: 'R',
    1: 'G',
    2: 'B',
    3: 'Y',
}

DIRECTIONS = {
    1: 'N',
    2: 'E',
    4: 'S',
    8: 'W',
}


game_map =[[9, 3, 9, 1, 5, 1, 1, 1, 1, 3, 9, 1, 1, 1, 5, 3, 
			8, 4, 0, 2, 9, 0, 0, 0, 0, 0, 0, 0, 0, 2, 9, 2, 
			8, 3, 8, 0, 0, 0, 0, 0, 0, 0, 2,12, 0, 0, 0, 2,
			8, 0, 0, 0, 0, 0, 6, 8, 0, 0, 0, 1, 0, 0, 0, 6, 
			8, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 3, 
		   12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 
			9, 0, 2,12, 0, 0, 0, 4, 4, 0, 4, 0, 0, 6, 8, 2, 
			8, 0, 0, 1, 0, 0, 2, 9, 3, 8, 3, 8, 0, 1, 0, 2, 
			8, 0, 0, 0, 0, 0, 2,12, 6, 8, 0, 0, 0, 0, 0, 6, 
			8, 4, 0, 2,12, 0, 0, 1, 5, 0, 0, 0, 0, 4, 0, 3, 
			8, 3, 8, 0, 1, 0, 0, 2, 9, 0, 0, 0, 2, 9, 0, 2, 
		   12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 8, 0, 0, 0, 2, 
			9, 0, 0, 0, 0, 0, 4, 0, 0, 0, 1, 0, 0, 2,12, 2, 
			8, 0, 0, 0, 0, 2, 9, 0, 0, 4, 0, 0, 0, 0, 1, 2, 
			8, 0, 6, 8, 0, 0, 0, 0, 0, 3, 8, 0, 0, 0, 0, 2, 
		   12, 4, 5, 6,12, 4, 4, 4, 4, 4, 4, 6,12, 4, 4, 6],
		   [9, 1, 1, 3, 9, 1, 1, 1, 1, 1, 3, 9, 1, 1, 1, 3, 
		   10,12, 0, 0, 0, 0, 4, 0, 2,12, 0, 0, 0, 0, 4, 2, 
			8, 1, 0, 0, 0, 0, 3, 8, 0, 1, 0, 0, 0, 0, 3,10, 
			8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 
			8, 0, 6, 8, 0, 0, 0, 4, 0, 0, 6, 8, 0, 0, 0, 6, 
		   12, 0, 1, 0, 0, 0, 2, 9, 0, 0, 1, 0, 4, 0, 0, 3, 
			9, 0, 0, 0, 0, 0, 0, 4, 4, 0, 0, 2, 9, 0, 0, 2, 
			8, 0, 0, 0, 0, 0, 2, 9, 3, 8, 0, 0, 0, 0, 0, 2, 
			8, 4, 0, 0, 0, 4, 2,12, 6, 8, 0, 0, 0, 0, 0, 6, 
			8, 3, 8, 0, 2, 9, 0, 1, 1, 0, 0, 0, 0, 4, 0, 3, 
		   12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 9, 0, 2, 
			9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 8, 0, 0, 0, 2, 
			8, 0, 0, 0, 0, 0, 6, 8, 0, 0, 1, 0, 0, 2,12, 2, 
			8, 0, 0, 0, 0, 0, 1, 0, 0, 4, 0, 0, 0, 0, 1, 2, 
			8, 2,12, 0, 0, 0, 0, 0, 0, 3, 8, 0, 0, 0, 0, 2, 
		   12, 4, 5, 4, 4, 6,12, 4, 4, 4, 4, 6,12, 4, 4, 6],
		  [ 9, 1, 1, 1, 3, 9, 1, 1, 1, 3, 9, 1, 1, 1, 5, 3,
			8, 4, 0, 0, 0, 0, 6, 8, 0, 0, 0, 0, 0, 2, 9, 2, 
		   10, 9, 0, 0, 0, 0, 1, 0, 0, 0, 2,12, 0, 0, 0, 2, 
			8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 6, 
			8, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 3, 
		   12, 0, 0, 0, 0, 0, 3, 8, 0, 0, 0, 0, 0, 0, 0, 2, 
			9, 0, 2,12, 0, 0, 0, 4, 4, 0, 4, 0, 0, 6, 8, 2, 
			8, 0, 0, 1, 0, 0, 2, 9, 3, 8, 3, 8, 0, 1, 0, 2, 
			8, 0, 0, 0, 0, 0, 2,12, 6, 8, 0, 0, 0, 0, 0, 2, 
			8, 0, 0, 6, 8, 0, 0, 1, 1, 2,12, 0, 0, 0, 0, 2, 
		   12, 0, 0, 1, 0, 4, 0, 0, 0, 0, 1, 0, 0, 0, 0, 6, 
			9, 0, 0, 0, 2, 9, 0, 0, 0, 6, 8, 0, 0, 0, 4, 3, 
			8, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 3,10, 
		   10,12, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 4, 0, 2, 
			8, 1, 0, 0, 0, 0, 3, 8, 0, 0, 0, 0, 2, 9, 0, 2, 
		   12, 4, 4, 4, 6,12, 4, 4, 4, 4, 6,12, 4, 4, 4, 6],
		   [9, 1, 5, 1, 3, 9, 1, 1, 1, 1, 3, 9, 5, 1, 1, 3,
			8, 2, 9, 0, 0, 0, 0, 0, 0, 0, 0, 2, 9, 0, 0, 2,
			8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2,12, 2,
			8, 0, 0, 0, 0, 2,12, 0, 0, 0, 0, 0, 0, 0, 1, 2,
		   12, 0, 0, 0, 4, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 6,
			9, 0, 0, 0, 3, 8, 0, 0, 0, 6, 8, 4, 0, 0, 0, 3,
			8, 6, 8, 0, 0, 0, 0, 4, 4, 1, 0, 3, 8, 0, 0, 2,
			8, 1, 0, 0, 0, 0, 2, 9, 3, 8, 0, 0, 0, 0, 0, 2,
			8, 0, 0, 4, 0, 0, 2,12, 6, 8, 0, 0, 0, 0, 0, 2,
			8, 0, 0, 3, 8, 0, 0, 1, 5, 0, 0, 0, 0, 0, 6,10,
			8, 0, 0, 0, 0, 0, 0, 0, 3, 8, 0, 0, 0, 0, 1, 6,
		   10,12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2,12, 0, 3,
			8, 1, 0, 0, 0, 0, 6, 8, 0, 0, 4, 0, 0, 1, 0, 2,
		   12, 0, 4, 0, 0, 0, 1, 0, 0, 2, 9, 0, 0, 0, 0, 2,
			9, 2, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2,
		   12, 4, 4, 4, 4, 6,12, 4, 4, 4, 4, 6,12, 4, 4, 6],
		   [9, 1, 1, 3, 9, 1, 1, 1, 1, 1, 3, 9, 1, 1, 1, 3,
			8, 0, 0, 0, 0, 0, 0, 0, 2,12, 0, 0, 0, 0, 4, 2,
			8, 0, 0, 0, 0, 6, 8, 0, 0, 1, 0, 0, 0, 0, 3,10,
			8, 0, 4, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2,
		   12, 0, 3, 8, 0, 0, 0, 0, 0, 0, 6, 8, 0, 0, 0, 6,
			9, 4, 0, 0, 0, 0, 2,12, 0, 0, 1, 0, 4, 0, 0, 3,
		   10, 9, 0, 0, 0, 0, 0, 5, 4, 0, 0, 2, 9, 0, 0, 2,
			8, 0, 0, 0, 0, 0, 2, 9, 3, 8, 0, 0, 0, 0, 0, 2,
			8, 0, 0, 4, 0, 0, 2,12, 6, 8, 0, 0, 0, 0, 0, 2,
			8, 0, 0, 3, 8, 0, 0, 1, 1, 2,12, 0, 0, 0, 0, 2,
			8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 6,
		   10,12, 0, 0, 0, 0, 0, 0, 0, 6, 8, 0, 0, 0, 4, 3,
			8, 1, 0, 0, 0, 0, 6, 8, 0, 1, 0, 0, 0, 0, 3,10,
		   12, 0, 4, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 4, 0, 2,
			9, 2, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 9, 0, 2,
		   12, 4, 4, 4, 4, 6,12, 4, 4, 4, 6,12, 4, 4, 4, 6]]

dll = CDLL('./_ricochet')

class Game(Structure):
    _fields_ = [
        ('grid', c_uint * 256),
        ('moves', c_uint * 256),
        ('robots', c_uint * 4),
        ('token', c_uint),
        ('last', c_uint),
    ]

def main(callback=None):
	rfp = open('map.txt', 'r');
	wfp = open('answer_map.txt', 'w');

	game = Game()
	l = rfp.readline();
	line = l.strip();
	color = int(line);

	robots = [];
	l = rfp.readline();
	line = l.strip().split(',');
	for l in line:
		robots.append(int(l));
	for index, value in enumerate(robots):
		game.robots[index] = value;
	for rob in robots:
		game.grid[rob] = game.grid[rob]+16;

	l = rfp.readline();
	line = l.strip();
	game.token = int(line);
	game.last = 0;

	for index, value in enumerate(game_map[0]):
		game.grid[index] = value;
	
	if color == 4:
		color = 1;
	colors = list('RGBY');
	game.robots[0], game.robots[color] = game.robots[color], game.robots[0];
	colors[0], colors[color] = colors[color], colors[0];
	path = create_string_buffer(256);
	depth = dll.search(byref(game), path, callback)
	result = []
	for value in path.raw[:depth]:
		value = ord(value)
		color = colors[(value >> 4) & 0x0f]
		direction = DIRECTIONS[value & 0x0f]
		result.append((color, direction))
	print(depth)
	print(result)

	for i in range(depth):
		wfp.write(result[i][0]+result[i][1]+' ')
#	wfp.write(result);


if __name__ == '__main__':
	main()
